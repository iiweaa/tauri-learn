# 第5课作业：文件系统操作

## 作业说明

完成本作业以巩固第五课的学习内容。作业分为**必做部分**和**选做部分**，请至少完成必做部分。

## 作业要求

### 必做作业（必须全部完成）

#### 任务1：安装和配置文件系统插件

- [ ] 在 `Cargo.toml` 中添加 `tauri-plugin-fs` 和 `tauri-plugin-dialog` 依赖
- [ ] 在 `main.rs` 中注册文件系统插件和对话框插件
- [ ] 在 `capabilities/default.json` 中添加所有必要的文件系统权限
- [ ] 验证插件安装成功（编译无错误）

#### 任务2：实现文件读取功能

- [ ] 创建一个"打开文件"按钮
- [ ] 点击按钮后打开文件对话框，支持选择 `.txt` 和 `.md` 文件
- [ ] 读取选择的文件内容
- [ ] 将文件内容显示在界面上（可以使用 `textarea` 或 `div`）
- [ ] 显示当前打开的文件路径
- [ ] 添加错误处理，如果文件读取失败，显示友好的错误提示

**参考代码结构**：
```javascript
const [fileContent, setFileContent] = useState('');
const [currentFile, setCurrentFile] = useState(null);

const handleOpenFile = async () => {
  // 实现打开文件对话框和读取文件
};
```

#### 任务3：实现文件写入功能

- [ ] 创建一个"保存文件"按钮
- [ ] 如果已经打开文件，直接保存到当前文件
- [ ] 如果没有打开文件，打开保存对话框，让用户选择保存位置
- [ ] 将界面上的内容写入文件
- [ ] 添加错误处理，如果文件写入失败，显示友好的错误提示
- [ ] 保存成功后显示提示信息

**参考代码结构**：
```javascript
const handleSaveFile = async () => {
  if (currentFile) {
    // 保存到当前文件
  } else {
    // 另存为
  }
};
```

#### 任务4：实现目录列表功能

- [ ] 创建一个"选择目录"按钮
- [ ] 点击按钮后打开目录选择对话框
- [ ] 读取选择的目录内容
- [ ] 在界面上显示目录下的所有文件和子目录
- [ ] 区分显示文件和目录（可以用图标或文字标识）
- [ ] 显示每个条目的名称

**参考代码结构**：
```javascript
const [directoryEntries, setDirectoryEntries] = useState([]);
const [currentDirectory, setCurrentDirectory] = useState(null);

const handleSelectDirectory = async () => {
  // 实现目录选择和读取
};
```

#### 任务5：实现文件存在性检查

- [ ] 创建一个功能，检查指定路径的文件是否存在
- [ ] 如果文件存在，显示文件信息（路径、是否存在）
- [ ] 如果文件不存在，显示"文件不存在"的提示
- [ ] 添加错误处理

**参考代码结构**：
```javascript
const checkFileExists = async (filePath) => {
  // 使用 exists() API 检查文件
};
```

### 选做作业（加分项）

#### 任务6：实现简单的文本编辑器（选做）

- [ ] 创建一个完整的文本编辑器界面
- [ ] 支持打开、编辑、保存文本文件
- [ ] 支持"另存为"功能
- [ ] 显示当前文件路径和状态（已保存/未保存）
- [ ] 添加基本的编辑功能（如清空、撤销等）

#### 任务7：实现文件管理器（选做）

- [ ] 创建一个文件管理器界面
- [ ] 显示当前目录的文件和子目录列表
- [ ] 支持双击目录进入子目录
- [ ] 支持返回上级目录
- [ ] 显示当前路径（面包屑导航）
- [ ] 支持文件预览（如果是文本文件，显示内容预览）

#### 任务8：实现文件操作功能（选做）

- [ ] 实现创建新目录功能
- [ ] 实现删除文件功能（带确认提示）
- [ ] 实现删除目录功能（带确认提示，支持递归删除）
- [ ] 实现文件重命名功能
- [ ] 所有操作都要有错误处理和用户反馈

#### 任务9：实现文件统计功能（选做）

- [ ] 读取文本文件并统计以下信息：
  - 字符数（包括空格）
  - 字符数（不包括空格）
  - 单词数
  - 行数
  - 文件大小（字节）
- [ ] 在界面上美观地显示这些统计信息
- [ ] 支持多个文件的批量统计

## 作业检查标准

### 功能完整性
- ✅ 所有必做任务的功能都已实现
- ✅ 功能运行正常，无崩溃或错误
- ✅ 错误处理完善，用户体验良好

### 代码质量
- ✅ 代码结构清晰，有适当的注释
- ✅ 使用了正确的API和权限配置
- ✅ 错误处理完善，有友好的错误提示

### 用户体验
- ✅ 界面美观，操作直观
- ✅ 有适当的加载提示和成功提示
- ✅ 错误提示清晰易懂

### Git提交
- ✅ 代码已提交到Git仓库
- ✅ 提交信息清晰明确
- ✅ 已推送到远程仓库（如适用）

## 提交方式

1. **完成代码实现**
   - 在 `my-first-tauri-app` 项目中实现所有必做任务
   - 确保代码可以正常编译和运行

2. **测试功能**
   - 测试所有实现的功能
   - 确保没有明显的bug
   - 测试错误处理是否完善

3. **提交代码**
   ```bash
   cd my-first-tauri-app
   git add .
   git commit -m "完成第5课作业：文件系统操作"
   git push
   ```

4. **告知老师**
   - 明确说明完成了哪些任务
   - 如有问题，说明遇到的问题和解决方法
   - 可以附上运行截图或说明

## 学习笔记要求

完成作业后，请创建学习笔记文档 `docs/notes/notes-05-file-system.md`，记录：

1. **遇到的问题**
   - 问题描述
   - 错误信息
   - 问题原因
   - 解决方法

2. **知识点总结**
   - 文件系统API的使用方法
   - 权限配置的要点
   - 文件对话框的使用
   - 错误处理的最佳实践

3. **心得体会**
   - 学习收获
   - 难点分析
   - 改进建议

## 提示和帮助

### 常见问题

**Q: 编译时提示找不到 `tauri-plugin-fs`？**
A: 确保在 `Cargo.toml` 中添加了依赖，并且运行了 `cargo build` 更新依赖。

**Q: 运行时提示权限不足？**
A: 检查 `capabilities/default.json` 中是否添加了相应的权限，如 `fs:allow-read-file`、`fs:allow-write-file` 等。

**Q: 文件对话框没有显示？**
A: 确保：
- 安装了 `tauri-plugin-dialog` 插件
- 在 `main.rs` 中注册了插件
- 在 `capabilities` 中添加了 `dialog:allow-open` 和 `dialog:allow-save` 权限

**Q: 如何测试文件操作功能？**
A: 可以：
- 在项目目录下创建测试文件
- 使用文件对话框选择文件
- 检查文件是否被正确读取或写入

### 参考资源

- [TAURI文件系统插件文档](https://v2.tauri.app/plugin/fs/)
- [TAURI对话框插件文档](https://v2.tauri.app/plugin/dialog/)
- 课程讲义：`docs/lessons/lesson-05-file-system.md`

---

**祝学习顺利！** 如有问题，随时向老师提问。完成作业后，记得提交代码并告知老师检查。

